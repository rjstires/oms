<br>
<% if @order_lines.count > 0 %>
<div class="col-md-2">
  <% @categories.each do |category| %>
  <%= active_link_to category.display_name,
        safe_params(:category => category.name),
        :active => :exact,
        class: 'btn btn-primary btn-md btn-block'
  %>
  <% end %>
  <br />
  <%= active_link_to 'All',
        url_for(params.except(:status)),
        :active => :exact,
        class: 'btn btn-primary btn-md btn-block'
  %>
  <% @order_line_statuses.each do |order_line_status| %>
  <%= active_link_to status_link_text(order_line_status),
        safe_params(:status => order_line_status[0]),
        :active => :exact,
        class: 'btn btn-primary btn-md btn-block'
  %>
  <% end %>
</div>
<% end %>
<div class="col-md-<%= @order_lines.count > 0 ? 10 : 12 %>">
  <%= link_to 'New Order line', new_team_order_line_path(@team) %>
  <table class="table table-striped table-hover order-lines">
    <thead>
      <tr>
        <%= date_column_header %>
        <th>Order</th>
        <th>Difficulty</th>
        <th>Zone</th>
        <th>Service</th>
        <th>Customer</th>
        <th>Character</th>
        <th>Sale</th>
        <th>Status</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @order_lines.each do |order_line| %>
      <tr>
        <%= date_value order_line %>
        <td><%= order_line.order %></td>
        <td><%= order_line.product.difficulty.display_name %></td>
        <td><%= order_line.product.zone.display_name %></td>
        <td><%= order_line.product.display_name %></td>
        <td><%= order_line.customer.display_name %></td>
        <td><%= order_line.character.display_name %></td>
        <td><%= number_to_currency(order_line.sale) %></td>
        <td><%= order_line.payment_status.display_name %></td>
        <td>
          <div class="dropdown">
            <button class="btn btn-xs dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              <i class="glyphicon glyphicon-cog"></i> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1">
              <%= content_tag :li, (link_to 'Show', team_order_line_path(order_line.team, order_line)) if can? :read, order_line %>
              <%= content_tag :li, (link_to 'Edit', edit_team_order_line_path(order_line.team, order_line)) if can? :update, order_line  %>
              <%= content_tag :li, (link_to 'Email Confirmation', team_order_line_send_confirmation_path(order_line.team, order_line)) if can? :send_confirmation, order_line  %>
              <%= content_tag :li, (link_to 'Mark Completed', team_order_line_complete_path(order_line.team, order_line)) if can? :complete, order_line if order_line.order_line_status == OrderLineStatus.scheduled %>
              <%= content_tag :li, (link_to 'Destroy', team_order_line_path(order_line.team, order_line), method: :delete, data: { confirm: 'Are you sure?' }) if can? :destroy, order_line  %>
            </ul>
          </div>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>
<br>
